{% load partials %}

<div class="notes-list space-y-1.5">
  {% if object.notes.all %}
    {% for note in object.notes.all %}
      <article class="bg-white shadow-sm text-xs leading-snug">
        <div
          class="flex items-center justify-between px-2 py-1 bg-gray-50/80 text-[11px]"
        >
          <div class="flex items-center gap-1.5">
            <span class="text-gray-700 font-medium"
              >{{ note.user.username }}</span
            >
            <span class="text-gray-400"
              >{{ note.created_at|date:"Y-m-d H:i" }}</span
            >
          </div>
          {% if user == note.user %}
            <button
              class="text-gray-400 hover:text-red-500 transition-colors"
              hx-delete="{% url 'lab:note_delete' note.id %}"
              hx-target="closest .notes-list"
              hx-swap="innerHTML"
              @click="$event.stopPropagation()"
            >
              <i class="fa-solid fa-xmark"></i>
            </button>
          {% endif %}
        </div>
        <p class="px-2 py-1 text-gray-700">{{ note.content }}</p>
      </article>
    {% endfor %}
  {% else %}
    <p class="text-gray-400 text-xs">No notes yet.</p>
  {% endif %}

  <div class="mt-2">
    <button
      class="w-full px-2 py-1 text-xs text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded transition-colors"
      hx-get="{% url 'lab:note_create' %}?content_type={{ content_type }}&object_id={{ object.id }}"
      hx-target="closest .notes-list"
      hx-swap="innerHTML"
      @click="$event.stopPropagation()"
    >
      <i class="fa-solid fa-plus mr-1"></i>
      Add a note...
    </button>
  </div>
</div>

{% extends "account/base.html" %}
{% load i18n %}
{% load account socialaccount %}
{% load widget_tweaks %}

{% block head_title %}{% trans "Sign In" %}{% endblock %}

{% block account_content %}
  <h2 class="card-title justify-center text-3xl font-bold text-center mb-4">{% trans "Sign In" %}</h2>

  {% get_providers as socialaccount_providers %}

  {% if socialaccount_providers %}
    <div class="flex flex-col gap-2 mb-4">
        {% include "socialaccount/snippets/provider_list.html" with process="login" %}
    </div>
    <div class="divider">{% trans "OR" %}</div>
  {% endif %}

  <form class="space-y-4" method="POST" action="{% url 'account_login' %}">
    {% csrf_token %}
    
    {% if form.errors %}
      <div class="alert alert-error">
        <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
        <span>{% blocktrans %}Please correct the errors below.{% endblocktrans %}</span>
      </div>
      {% for field in form %}
          {% for error in field.errors %}
              <div class="text-error text-sm">{{ error }}</div>
          {% endfor %}
      {% endfor %}
      {% for error in form.non_field_errors %}
          <div class="text-error text-sm">{{ error }}</div>
      {% endfor %}
    {% endif %}

    <div class="form-control">
      <label class="label">
        <span class="label-text">{% trans "Email" %}</span>
      </label>
      {% render_field form.login class="input input-bordered w-full" placeholder="email@example.com" %}
    </div>

    <div class="form-control" x-data="{ show: false }">
      <label class="label">
        <span class="label-text">{% trans "Password" %}</span>
      </label>
      <div class="relative">
        <input 
            type="password" 
            name="{{ form.password.html_name }}" 
            id="{{ form.password.id_for_label }}"
            class="input input-bordered w-full pr-10" 
            x-bind:type="show ? 'text' : 'password'" 
            placeholder="********"
            {% if form.password.field.required %}required{% endif %}
            autocomplete="current-password"
        >
        <button type="button" @click="show = !show" class="absolute inset-y-0 right-0 flex items-center pr-3 cursor-pointer text-base-content/70 hover:text-base-content">
            <svg x-show="!show" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
            <svg x-show="show" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5" style="display: none;">
              <path stroke-linecap="round" stroke-linejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L9.88 9.88" />
            </svg>
        </button>
      </div>
      <label class="label">
        <a href="{% url 'account_reset_password' %}" class="label-text-alt link link-hover">{% trans "Forgot Password?" %}</a>
      </label>
    </div>

    {% if redirect_field_value %}
    <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
    {% endif %}

    <div class="card-actions justify-end mt-4">
      <button class="btn btn-primary w-full" type="submit">{% trans "Sign In" %}</button>
    </div>
  </form>
  
  <div class="text-center mt-4">
    <span class="text-sm">{% trans "Don't have an account?" %} </span>
    <a href="{{ signup_url }}" class="link link-primary text-sm">{% trans "Sign Up" %}</a>
  </div>
{% endblock %}
